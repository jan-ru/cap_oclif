# Keycloak Authentication Configuration

# Required: Keycloak server URL
KEYCLOAK_URL=https://your-keycloak-server.com

# Required: Keycloak realm name
KEYCLOAK_REALM=your-realm

# Required: JWT issuer (typically same as Keycloak URL + realm)
JWT_ISSUER=https://your-keycloak-server.com/realms/your-realm

# Optional: Keycloak client ID for service account authentication
KEYCLOAK_CLIENT_ID=your-client-id

# Optional: Keycloak client secret for service account authentication
KEYCLOAK_CLIENT_SECRET=your-client-secret

# Optional: JWT audience validation
JWT_AUDIENCE=your-audience

# Optional: Supported JWT algorithms (comma-separated)
JWT_ALGORITHMS=RS256,RS384,RS512

# Optional: JWT clock tolerance in seconds (default: 30)
JWT_CLOCK_TOLERANCE=30

# Optional: JWKS cache timeout in milliseconds (default: 3600000 = 1 hour)
JWKS_CACHE_TIMEOUT=3600000

# Optional: JWKS rate limit (default: 10)
JWKS_RATE_LIMIT=10

# Optional: JWKS requests per minute (default: 5)
JWKS_REQUESTS_PER_MINUTE=5

# Optional: Rate limiting window in milliseconds (default: 900000 = 15 minutes)
RATE_LIMIT_WINDOW_MS=900000

# Optional: Maximum requests per rate limit window (default: 100)
RATE_LIMIT_MAX_REQUESTS=100

# Optional: Require HTTPS for authentication (default: true)
REQUIRE_HTTPS=true

# Optional: Allowed CORS origins (comma-separated)
ALLOWED_ORIGINS=https://your-frontend.com,https://another-domain.com

# Optional: Log level (default: info)
LOG_LEVEL=info

# Optional: Enable audit logging (default: true)
AUDIT_ENABLED=true

# Optional: Include token claims in logs (default: false, security sensitive)
INCLUDE_TOKEN_CLAIMS=false